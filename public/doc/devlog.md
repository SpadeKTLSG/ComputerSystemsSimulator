‍

‍

# 前期设计

记录存放本地, 项目完结后上传

1.21 上传组长的开发日志

```xml
12.6 建立了项目结构
12.11 完成了实体的信息创建与原型设计和概念理解

```

## 明确任务 12.2

‍

_锁链式的整体构想_

- 一个鸡桶
- 一个完美完成任务的鸡桶
- 一个完美完成任务并且形成了良好交互性的鸡桶

‍

> 下面是整理的任务书和老师课堂口头交代的对应项目要求

‍

- ==进程管理==: 基于时间片轮转调度算法, 包括进程的创建、撤销、状态转换，在采用时间片轮转调度算的基础上实现进程调度；
- ==内存管理==：基于分页的离散内存空间分配与回收算法的内存管理；
- ==文件管理==：在采用显示链接文件结构和基于位示图磁盘分配算法的基础上实现单用户的磁盘文件管理部分，包括：文件的逻辑结构、文件的物理结构、目录结构、磁盘分配回收、文件的保护和用户接口。
- ==设备管理==：设备的分配和回收，实现设备独立性

‍

### 通用

‍

模拟采用多道程序设计方法的单用户操作系统，该操作系统包括进程管理、存储管理、设备管理和文件管理四部分。

根据操作系统理论课上学习的操作系统中关于进程管理、存储管理、设备管理和文件管理实现方法，实现主存分配与回收、外存块的分配与回收、进程的创建、撤销、阻塞唤醒和进程调度，设备的分配和回收等功能

‍

重点 **熟悉操作系统四大功能的实现原理**

难点 **进程** + **文件**管理实现(双核心)

‍

注意: 任务书提到的点, 必须严格按照任务书需求制作，==**多了扣分!!!**==

有思路, 就开做, ~~没思路跟着课设实验课课堂小任务(大伙靠自己就可咯)~~

**以下是细则, 按照进程-内存-文件-设备作了整理**

‍

‍

---

### 进程管理

主要包括进程调度，进程的创建和撤销、进程的阻塞和唤醒，中断作用的实现。

‍

使用单用户系统, 要求能跑多任务

CPU 进程使用函数解释执行模拟（响应中断等）

‍

‍

#### ⑴ 硬件工作的模拟

‍

##### ① 中央处理器的模拟

用函数 CPU( )(该函数不能有参数)模拟中央处理器。

该函数主要负责解释“可执行文件”中的命令。

‍

##### ② 主要寄存器的模拟

用全局变量模拟重要寄存器，如程序状态寄存器等。

‍

##### ③ 中断的模拟

中断的发现应该是硬件的工作，这里在函数 CPU 中加检测 PSW 的方式来模拟

‍

模拟中断的种类有如下几种：

程序结束、时间片到、I/O 中断。

‍

##### ④ 时钟的模拟。

系统中的绝对时钟和相对时钟用全局变量模拟。

‍

#### ⑵ 进程控制块

进程控制块内容包括进程标识符、主要寄存器内容、进程状态、等待原因、进程页表位置、中间结果等等。本模拟系统最多容纳 10 个进程块。

‍

#### ⑶ 进程调度

进程调度在模拟系统中，采用时间片轮转调度算法。

‍

#### ⑷ 进程控制

建立四个函数模拟进程创建、撤销、阻塞和唤醒四个原语。

‍

‍

---

### 内存管理

内存使用数组模拟

‍

采用页式存储管理方式

‍

存储管理部分主要实现主存空间的分配和回收、存储保护

‍

模拟系统中，内存部分分为两部分

一部分是系统区，这里只存放进程控制块，一部分是用户区，这里主要是对用户区的管理

‍

‍

---

### 文件管理

‍

文件管理部分实现的主要是单用户的磁盘文件管理部分，包括文件的逻辑结构、物理结构、目录、磁盘分配回收、文件的保护和用户接口的实现。

‍

- 判断文件重名问题
- 判断文件对应块数问题 有几个块，放哪里空位置
- 10 还是 1 0 问题

要求断电保护：持久化文件到硬盘

‍

‍

#### ⑴ 文件的逻辑结构

文件的逻辑结构采用流式结构；

文件的内容均采用文本文件；

文件中要有一种特定命令的“可执行”文件，该文件中的命令有：

x=?; 给 x 赋值一位数

x++; x 加 1

x--; x 减 1

!??； 第一个？为 A,B,C 中某个设备，第二个？为一位数，表示使用设备的时间；

end. 表示文件结束，同时将结果写入文件 out，其中包括文件路径名和 x 的值。

‍

#### ⑵ 磁盘模拟

用一个文件 disk 模拟磁盘，磁盘的每个盘块 64 字节，模拟磁盘共有 128 块。第 0、1 块存放文件分配表，第 2 块存放根目录，其余存放子目录和文件。

‍

#### ⑶ 目录结构

目录结构采用树型目录结构。

‍

可以用数字 129 代表结束符号

注意空间多次分配问题

清空方法 无需擦除，直接标记不存在

嵌套回收 类似 rmdir -指令，里面的依次删除

‍

‍

**设计方法**

- 0 块 64 字节 FAT 128 项，占用两项 128 字节 (前三块 FAT 里面都是 128)
- 1 块 64 字节 FAT （里面是每一个文件的块号等）
- 2 块 系统根目录，限制其最大创建数量（FCB 大小限制 8 个）
- 3-127 块 文件相关内容

‍

‍

##### ① 目录项内容（8 个字节）

目录名、文件名：3 个字节；

扩展名：2 个字节（目录为空）；

目录、文件属性：1 字节；

起始盘块号：1 个字节；

文件长度：1 字节（目录没有长度）。

‍

##### ② 根目录

根目录位置固定，为磁盘第 2 块，大小固定，共 8 项；

‍

##### ③ 子目录

位置不固定，大小不固定（至少建立一级子目录，最好支持多级子目录）。

‍

#### ⑷ 磁盘分配

磁盘的分配采用链接结构（显式链接）的分配。

硬盘在 txt.

-最大长度 255 提示（交互式）

要求磁盘可视化

‍

#### ⑸ 磁盘空闲存储空间管理

‍

磁盘空闲存储空间管理采用位示图方法。

**位示图和显示链接的指针合在一起组成文件分配表，** 占用磁盘空间第 0、1 块。

‍

#### ⑹ 用户接口

用户接口提供用户命令接口，要求实现以下命令：

创建文件：create 拷贝文件：copy 删除文件：delete 移动文件：move 显示文件：type

改变文件属性：change 建立目录：makdir 改变目录路径：chadir 删除目录：deldir

‍

运行可执行文件：可执行文件的文件名（创建进程）。

‍

‍

---

### 设备管理

‍

主要包括设备的分配和回收。

模拟系统中有 A、B、C 三种设备，采用安全分配方式。

‍

课堂无其他要求

‍

### 界面设计

‍

需要两种界面(老师建议:别头重脚轻先写前端, 先把底层实现咯)

‍

文件菜单类似 win10 文件管理器

命令执行框，类似 linux 命令行 ->命令列表见 word

‍

可视化进程展示功能：执行中，挂起等

‍

可以根据块的状态更换颜色

可以设置生成按钮用于调试

‍

屏幕显示要求付

[操作系统设计图](D:\Workshop\Data\外置笔记图床)

‍

‍

### 后勤队长

也就是组长但是责任可以被拆分

‍

环境装配统一

论文撰写

任务协商布置

代码冲突解决

任务完成度审阅

测试接口

联调

代码展示

...

‍

总之, 不在上面规定的代码开发内容都在这里

‍

‍

‍

‍

‍

## 职务分配 12.3

‍

12.3 完成了职务分配

‍

> 4 人一组，刚好四个需求一个人负责一种管理或者后勤
>
> 3 人 -> 职务认领 TODO
>
> ‍
>
> **职务划分 KV Table**
>
> **(K: Name, V: ValueOfTask)**
>
> 百分制 sum = 100
>
> ‍
>
> ==核心方面==
>
> 进程管理(难) 25 W.
>
> 内存管理(中) 18
>
> ‍
>
> ==外围方面==
>
> 文件管理(难) 25
>
> 设备管理(易) 4
>
> ‍
>
> ==交互方面==
>
> 界面设计(中) 18
>
> ‍
>
> ==其他==
>
> 文档后勤(杂) 8
>
> ‍
>
> > 如何生成这样的一个 KV 任务分配表?
> >
> > 使用 5 或者 10 作为最小细分值, 加权分配 100 为基数的任务量
> >
> > 难 = 15 , 中 = 10, 易 = 5, 杂 = 8,
> >
> > Sum= 30 + 20 + 5 + 8 = 63
> >
> > Every in List (n)-> n / (63/100) #换算为对应%的分值. 换算比为 0.6
> >
> > 得出每个任务项的%
> >
> > {25,18,9,4} = 99, 余下 1%吃了
>
> ‍
>
> 每人领取分值, 使得最后组内任务分配较为平均
>
> 这便是绝对公平的分配方法!!!

‍

> 咋看下来没有划分头绪，但是我们可以作排除法：
>
> 1，谁来负责后勤（最后一项）  
> 外力是大创的负责人，因此客观来看应当从剩下两人中选：结果选出来是我。
>
> （当然，目前撰写这个项目安排，整理资料也是后勤一部分，未来如果老师有事情通知而我没有收到也记得大伙保存一下）
>
> 2，分析已经中标的项目以及个人分值约束表  
> 操作系统内核部分，W 冰选择了进程  
> 交互方面外力自荐做页面展示
>
> 当前分值：（W，A，C）（25，18，8）
>
> 3 两种基础方案，PLAN A，B
>
> PLAN A：分值驱动  
> 按照分值平均分配  
> 自动生成的结果：
>
> C：文件 25+ 后勤 8 33  
> A：界面 18+ 内存 18 36  
> W：进程 25+ 设备 4 29
>
> 理由  
> 这样一来分值基本 30 上下  
> 更趋向公平的选择
>
> PLAN B 任务驱动
>
> C：后勤+设备 12  
> A：界面+文件 43  
> W：系统核心两项 43
>
> 理由  
> 成员提出从实际的任务时长来算，后勤的权重会变得很高，因此不能再给予分派项目核心代码开发工作  
> 同时可以保证系统核心是一个人掌控，利于共同开发
>
> PLAN C 上面两个的综合
>
> 各位投票吧，发 ABC

‍

‍

## 联合军演 12.6

‍

12.6

完成了

- 分支管理

  - First Pull Requests 11:32 将开发分支合并到 master 分支

    使用了[仓库镜像管理](https://help.gitee.com/repository/settings/sync-between-gitee-github#article-header10), 优雅的同步 Gitee -> Github

    使用了个人令牌 专用于 LibDBMS & CSS 仓库, 包含对仓库的全部权限

    ```java
    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
    ```

    还有一个前端令牌

    ```java
    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
    ```

- 项目构建
- 文档同步
- 基础开发工程

‍

‍

‍

‍

## 实施建议 12.7

‍

> "如何规划自己的任务安排? 我的建议是在甲方的要求之下进行扩充与外延"  
> 什么事甲方?  
> 书本, 教材, 老师要求, 任务书
>
> ‍
>
> ---
>
> 先附上一份甲方要求  
> (整理的, 全在这里)
>
> 基于分页 的离散内存空间分配 与 回收算法 的内存管理
>
> 内存使用数组模拟
>
> 采用页式存储管理方式
>
> 存储管理部分主要实现主存空间的分配和回收、存储保护
>
> 模拟系统中，内存部分分为两部分
>
> 一部分是系统区，这里只存放进程控制块，一部分是用户区，这里主要是对用户区的管理
>
> ---
>
> 没有太多内容. 相比于其他部分  
> 但是很明显可以看到几个点:
>
> 1. 页式存储管理方式  
>    2.离散内存空间分配  
>    3.回收算法
> 2. 系统用户双分区
> 3. 进程控制块
>
> 这五个点, 每一个都可以扩充为许多问题, 例如:  
> 回收算法? 是什么? 怎么实现? 怎么把它加到这个体系中去?  
> 离散空间分配是什么? 书本概念要求是什么呢? 怎么把它加到这个体系中去?  
> 项目的基础结构怎么做? 书上有具体实现吗  
> ...
>
> 这部分就是各个人负责各自模块的思维风暴了, 通过这样的思维路径, 你可以找到如何完成自己项目模块的方法  
> ; )
>
> 以上 @A

‍

我也会这么来管理我的项目设计的!

‍

## 正式开发 12.11

‍

终于忙完了数据库那边的事情, 这边赶紧加把劲

见项目的记录本内

‍

废弃的文件管理要求

‍

如何规划自己的任务安排

‍

问题解决

- 判断文件重名问题
- 判断文件对应块数问题 有几个块，放哪里空位置
- 10 还是 1 0 问题

‍

‍

### 文件

‍

均采用文本文件

‍

采用流式结构: 将数据按顺序组织成记录集合并积累保存，以字节(Byte)为单位

因此文件最大大小 255 个字符 `(2的8次方) 11111111 - 00000000 8位=1B`​

交互式输入文本最大长度 255

‍

‍

#### 特定要求

‍

可执行 bash 文件

‍

**命令列表**

- x=?; 给 x 赋值一位数
- x++; x 加 1
- x--; x 减 1
- !??； 第一个？为 A,B,C 中某个设备，第二个？为一位数，表示使用设备的时间；
- end. 表示文件结束，同时将结果写入文件**out**，其中包括文件路径名和 x 的值。

‍

#### 接口功能

‍

用户接口提供用户命令接口

‍

创建文件：create

拷贝文件：copy

删除文件：delete

移动文件：move

显示文件：type

改变文件属性：change

建立目录：makdir

改变目录路径：chadir

删除目录：deldir

‍

运行可执行文件：可执行文件的文件名（创建进程）

‍

‍

### 磁盘

链接结构（显式链接）的分配

‍

磁盘的每个盘块 64 字节，模拟磁盘共有 128 块。第 0、1 块存放文件分配表，第 2 块存放根目录，其余存放子目录和文件

‍

空闲存储空间管理采用**位示图, 分配回收磁盘块类似页式**

利用二进制的一位来表示磁盘中的一个盘块的使用情况。当其值为“0”时，表示对应的盘块空闲；为“1”时，表示已经分配

‍

**位示图和显示链接的指针合在一起组成文件分配表 FAT, 128 项，** 占用两项 128 字节，占用磁盘空间第 0、1 块

利用一行一个键值对实现 {第几项:内容}

- 0 块 64 字节
- 1 块 64 字节 FAT
- 2 块 **系统根目录**，限制其最大创建数量（FCB 大小限制 8 个）
- 3-127 块 文件相关内容

‍

‍

### 目录

树型多级目录结构

‍

用数字 129(磁盘只有 128 块)代表目录中的结束符号

注意空间多次分配问题

‍

‍

#### 目录项

‍

- 文件名+目录名 3B
- 扩展名 2B （目录为空）
- 文件目录标识 1B 0/1/2...
- 起始盘块号 1B
- 文件长度 1B （目录为空）

‍

#### 根目录

根目录位置固定，为磁盘第 2 块，大小固定

‍

模仿 linux 目录结构

- home 用户子目录
- app 应用程序目录
- tmp 临时可变目录
- conf 配置文件目录
- mnt 设备挂载目录
- bin 可执行命令目录
- lib 系统库文件以及系统资料目录
- boot 系统内核程序目录

‍

‍

#### 子目录

位置不固定，大小不固定, 支持多级子目录

‍

# 转移阵地

转移到项目记录

‍

## 组长职责

‍

### 同步文档

[有道云](https://note.youdao.com/web/#/file/B1AFDBEB827F408BAFF556F2A13FE574/markdown/WEB5bc02b89c425b99371f86e2cdf781ada/)
